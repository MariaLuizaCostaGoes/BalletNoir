const perguntasFemininas = [
    {
        pergunta: 'Qual dessas qualidades você mais valoriza em si?',
        respostas: [
            { alternativa: 'Delicadeza e graça', variacao: 'FadaAçucarada' },
            { alternativa: 'Alegria e vivacidade', variacao: 'GisellePrimeiroAto' },
            { alternativa: 'Tristeza e beleza etérea', variacao: 'GiselleSegundoAto' },
            { alternativa: 'Força e independência', variacao: 'Kitri' },
        ],
    },
    {
        pergunta: 'Em um momento de crise, o que você faz?',
        respostas: [
            { alternativa: 'Mantém a esperança com ternura', variacao: 'Aurora' },
            { alternativa: 'Reage com inteligência e audácia', variacao: 'Esmeralda' },
            { alternativa: 'Expressa sentimentos com intensidade', variacao: 'Odile' },
            { alternativa: 'Age com leveza, buscando harmonia', variacao: 'Cupido' },
        ],
    },
    {
        pergunta: 'Como você lida com o amor?',
        respostas: [
            { alternativa: 'Com devoção, mesmo diante do sofrimento', variacao: 'NikiyaPrimeiroAto' },
            { alternativa: 'Com mistério e sedução', variacao: 'Scherazade' },
            { alternativa: 'Com paixão alegre e determinada', variacao: 'Kitri' },
            { alternativa: 'Com leveza e idealismo', variacao: 'FadaAçucarada' },
        ],
    },
    {
        pergunta: 'O que mais te atrai em uma apresentação de balé?',
        respostas: [
            { alternativa: 'Elegância e precisão técnica', variacao: 'Paquita' },
            { alternativa: 'Energia e empolgação', variacao: 'ChamasdeParis' },
            { alternativa: 'Espiritualidade e lirismo', variacao: 'GiselleSegundoAto' },
            { alternativa: 'Movimentos leves e fantasiosos', variacao: 'Cupido' },
        ],
    },
    {
        pergunta: 'Qual dessas frases te representa melhor?',
        respostas: [
            { alternativa: 'Sou como um espírito que protege quem amo', variacao: 'GiselleSegundoAto' },
            { alternativa: 'Minha alegria é contagiante', variacao: 'GisellePrimeiroAto' },
            { alternativa: 'Uso charme como minha arma', variacao: 'Odile' },
            { alternativa: 'Tenho uma força que poucos enxergam', variacao: 'Esmeralda' },
        ],
    },
    {
        pergunta: 'Escolha uma ambientação que mais te atrai:',
        respostas: [
            { alternativa: 'Um reino encantado feito de doces', variacao: 'FadaAçucarada' },
            { alternativa: 'Uma floresta mágica cheia de seres místicos', variacao: 'Cupido' },
            { alternativa: 'Uma cidade vibrante durante uma revolução', variacao: 'ChamasdeParis' },
            { alternativa: 'Um palácio exótico cheio de mistério', variacao: 'Scherazade' },
        ],
    },
    {
        pergunta: 'Quando está em público, você tende a...',
        respostas: [
            { alternativa: 'Encantar com charme e carisma', variacao: 'Paquita' },
            { alternativa: 'Impressionar com intensidade dramática', variacao: 'Odile' },
            { alternativa: 'Cativar pela sutileza e elegância', variacao: 'Aurora' },
            { alternativa: 'Animar o ambiente com alegria', variacao: 'Kitri' },
        ],
    },
    {
        pergunta: 'Qual dessas figuras históricas ou literárias você mais se identifica?',
        respostas: [
            { alternativa: 'Uma cigana rebelde e livre', variacao: 'Esmeralda' },
            { alternativa: 'Uma princesa destinada a grandes feitos', variacao: 'Aurora' },
            { alternativa: 'Uma sacerdotisa apaixonada e trágica', variacao: 'NikiyaPrimeiroAto' },
            { alternativa: 'Uma heroína romântica e leal', variacao: 'GiselleSegundoAto' },
        ],
    },
    {
        pergunta: 'Como você gostaria de ser lembrada?',
        respostas: [
            { alternativa: 'Por minha leveza e delicadeza', variacao: 'FadaAçucarada' },
            { alternativa: 'Por minha coragem e intensidade', variacao: 'Scherazade' },
            { alternativa: 'Por minha nobreza e elegância', variacao: 'Paquita' },
            { alternativa: 'Por minha paixão e força', variacao: 'Kitri' },
        ],
    },
    {
        pergunta: 'Como você age quando está apaixonada?',
        respostas: [
            { alternativa: 'Com doçura e admiração', variacao: 'GisellePrimeiroAto' },
            { alternativa: 'Com intensidade e entrega', variacao: 'NikiyaPrimeiroAto' },
            { alternativa: 'Com sedução e mistério', variacao: 'Scherazade' },
            { alternativa: 'Com energia e ousadia', variacao: 'ChamasdeParis' },
        ],
    },
    {
        pergunta: 'Qual dessas características é mais você?',
        respostas: [
            { alternativa: 'Majestosa e decidida', variacao: 'Aurora' },
            { alternativa: 'Romântica e doce', variacao: 'GisellePrimeiroAto' },
            { alternativa: 'Brincalhona e amorosa', variacao: 'Cupido' },
            { alternativa: 'Energética e rebelde', variacao: 'ChamasdeParis' },
        ],
    },
    {
        pergunta: 'Se fosse uma personagem de conto de fadas, seria...',
        respostas: [
            { alternativa: 'A fada encantada que guia os outros', variacao: 'FadaAçucarada' },
            { alternativa: 'A princesa que supera desafios', variacao: 'Aurora' },
            { alternativa: 'A heroína que luta por justiça', variacao: 'Esmeralda' },
            { alternativa: 'A mulher misteriosa que guarda um segredo', variacao: 'Scherazade' },
        ],
    },
    {
        pergunta: 'Qual desses temas mais te inspira?',
        respostas: [
            { alternativa: 'Redenção e perdão', variacao: 'GiselleSegundoAto' },
            { alternativa: 'Liberdade e aventura', variacao: 'ChamasdeParis' },
            { alternativa: 'Elegância e tradição', variacao: 'Paquita' },
            { alternativa: 'Sedução e engano', variacao: 'Odile' },
        ],
    },
    {
        pergunta: 'Qual dessas emoções você expressa melhor?',
        respostas: [
            { alternativa: 'Espiritualidade e entrega', variacao: 'NikiyaPrimeiroAto' },
            { alternativa: 'Fúria contida e poder', variacao: 'Odile' },
            { alternativa: 'Carisma e leveza', variacao: 'Kitri' },
            { alternativa: 'Ternura e inocência', variacao: 'GisellePrimeiroAto' },
        ],
    },
];


const perguntasMasculinas = [
    {
        pergunta: 'Qual dessas qualidades mais te define?',
        respostas: [
            { alternativa: 'Força e paixão', variacao: 'Solor' },
            { alternativa: 'Espírito aventureiro e charme', variacao: 'Basilio' },
            { alternativa: 'Nobreza e fidelidade', variacao: 'PríncipeDésiré' },
            { alternativa: 'Leveza mágica e mistério', variacao: 'OPássaroAzul' },
        ],
    },
    {
        pergunta: 'O que melhor representa sua motivação?',
        respostas: [
            { alternativa: 'Proteger quem amo, mesmo com risco', variacao: 'JeandeBrienne' },
            { alternativa: 'Buscar liberdade e aventura', variacao: 'OCorsario' },
            { alternativa: 'Lutar contra o destino por amor', variacao: 'PríncipeSiegfried' },
            { alternativa: 'Demonstrar lealdade com talento', variacao: 'Ali' },
        ],
    },
    {
        pergunta: 'Qual dessas cenas mais te emociona?',
        respostas: [
            { alternativa: 'Sonhar com quem perdeu', variacao: 'Solor' },
            { alternativa: 'Fingir a morte por amor', variacao: 'Basilio' },
            { alternativa: 'Despertar alguém com um beijo', variacao: 'PríncipeDésiré' },
            { alternativa: 'Flutuar como uma criatura etérea', variacao: 'OPássaroAzul' },
        ],
    },
    {
        pergunta: 'Como você lida com desafios?',
        respostas: [
            { alternativa: 'Com heroísmo e bravura', variacao: 'JeandeBrienne' },
            { alternativa: 'Com intensidade emocional', variacao: 'PríncipeSiegfried' },
            { alternativa: 'Com astúcia e coragem pirata', variacao: 'OCorsario' },
            { alternativa: 'Com virtuosismo e habilidade', variacao: 'Ali' },
        ],
    },
    {
        pergunta: 'Qual dessas palavras mais ressoa com você?',
        respostas: [
            { alternativa: 'Redenção', variacao: 'Albrecht' },
            { alternativa: 'Aventura', variacao: 'Basilio' },
            { alternativa: 'Leveza', variacao: 'OPássaroAzul' },
            { alternativa: 'Destino', variacao: 'PríncipeSiegfried' },
        ],
    },
    {
        pergunta: 'Você prefere ser reconhecido por...',
        respostas: [
            { alternativa: 'Sua bravura em batalha', variacao: 'JeandeBrienne' },
            { alternativa: 'Sua elegância e nobreza', variacao: 'PríncipeDésiré' },
            { alternativa: 'Sua ousadia e astúcia', variacao: 'Basilio' },
            { alternativa: 'Sua liberdade conquistada', variacao: 'OCorsario' },
        ],
    },
    {
        pergunta: 'O que mais te atrai em uma história?',
        respostas: [
            { alternativa: 'Sacrifício por amor', variacao: 'Solor' },
            { alternativa: 'Tragédia e perdão', variacao: 'Albrecht' },
            { alternativa: 'Virtuosismo e lealdade', variacao: 'Ali' },
            { alternativa: 'Conflito de honra e dever', variacao: 'PríncipeSiegfried' },
        ],
    },
    {
        pergunta: 'Como você descreveria sua energia?',
        respostas: [
            { alternativa: 'Explosiva e intensa', variacao: 'Ali' },
            { alternativa: 'Contida, mas poderosa', variacao: 'PríncipeDésiré' },
            { alternativa: 'Alegre e despreocupada', variacao: 'Basilio' },
            { alternativa: 'Firme e determinada', variacao: 'Acteon' },
        ],
    },
    {
        pergunta: 'Em uma situação crítica, você...',
        respostas: [
            { alternativa: 'Luta até o fim, mesmo com medo', variacao: 'Acteon' },
            { alternativa: 'Segue seu coração, custe o que custar', variacao: 'Solor' },
            { alternativa: 'Usa sua inteligência e leveza', variacao: 'OPássaroAzul' },
            { alternativa: 'Toma decisões com base na justiça', variacao: 'JeandeBrienne' },
        ],
    },
    {
        pergunta: 'Se pudesse escolher um destino, seria...',
        respostas: [
            { alternativa: 'A redenção após o erro', variacao: 'Albrecht' },
            { alternativa: 'Uma jornada em alto-mar', variacao: 'OCorsario' },
            { alternativa: 'A vitória sobre um grande inimigo', variacao: 'Acteon' },
            { alternativa: 'Um final de conto de fadas', variacao: 'PríncipeDésiré' },
        ],
    },
];


const pontuacaoFeminina = {
    FadaAcucarada: 0,
    GisellePrimeiroAto: 0,
    GiselleSegundoAto: 0,
    Peasant: 0,
    Cupido: 0,
    Kitri: 0,
    Odile: 0,
    Aurora: 0,
    Esmeralda: 0,
    Paquita: 0,
    Raymonda: 0,
    Medora: 0,
    NikiyaPrimeiroAto: 0,
    NikiyaSegundoAto: 0,
    OPássaroAzul: 0,
    Petrouchka: 0,
    Spartacus: 0,
    ChamasdeParis: 0,
    OTalismã: 0,
    Scherazade: 0,
};

const pontuacaoMasculina = {
    Solor: 0,
    Basilio: 0,
    PríncipeSiegfried: 0,
    PríncipeDésiré: 0,
    Albrecht: 0,
    JeandeBrienne: 0,
    Ali: 0,
    Acteon: 0,
    OCorsaire: 0,
    OPássaroAzul: 0,
};


const perguntaElement = document.getElementById("pergunta");
const respostasButtons = document.getElementById("resposta-buttons");
const nextButtons = document.getElementById("next-btn");

// ver qual questão é a atual
let IndexPergunta = 0

function dataHoraMomento() {
    const date = new Date();
    const ano = date.getFullYear();
    const mes = String(date.getMonth() + 1).padStart(2, '0');
    const dia = String(date.getDate()).padStart(2, '0');
    const horas = String(date.getHours()).padStart(2, '0');
    const minutos = String(date.getMinutes()).padStart(2, '0');
    const segundos = String(date.getSeconds()).padStart(2, '0');

    const dataHoraFormatada = `${ano}-${mes}-${dia} ${horas}:${minutos}:${segundos}`;
    return dataHoraFormatada;
};

function startQuizFem() {
    IndexPergunta = 0
    mostrarPerguntaFem();
    inicioQuiz(dataHoraMomento(), "Fem");

}

function startQuizMasc() {
    IndexPergunta = 0
    mostrarPerguntaMasc();
    inicioQuiz(dataHoraMomento(), "Masc");
}

let currentQuestionMasc = '';
let currentQuestionFem = '';


function mostrarPerguntaFem() {
    currentQuestionFem = perguntasFemininas[IndexPergunta].pergunta
    console.log(currentQuestionFem)
    perguntaElement.innerHTML = currentQuestionFem
    mostrarALternativasFem()
}

function mostrarPerguntaMasc() {
    currentQuestionMasc = perguntasMasculinas[IndexPergunta].pergunta
    console.log(currentQuestionMasc)
    perguntaElement.innerHTML = currentQuestionMasc
    mostrarALternativasMasc()
}

function mostrarALternativasFem() {

    var botao1 = document.getElementById('btn-1')
    var botao2 = document.getElementById('btn-2')
    var botao3 = document.getElementById('btn-3')
    var botao4 = document.getElementById('btn-4')
    var pergunta = perguntasFemininas[IndexPergunta].respostas;
    botao1.innerHTML = pergunta[0].alternativa
    botao2.innerHTML = pergunta[1].alternativa
    botao3.innerHTML = pergunta[2].alternativa
    botao4.innerHTML = pergunta[3].alternativa
}

function mostrarALternativasMasc() {

    var botao1 = document.getElementById('btn-1')
    var botao2 = document.getElementById('btn-2')
    var botao3 = document.getElementById('btn-3')
    var botao4 = document.getElementById('btn-4')
    var pergunta = perguntasMasculinas[IndexPergunta].respostas;
    botao1.innerHTML = pergunta[0].alternativa
    botao2.innerHTML = pergunta[1].alternativa
    botao3.innerHTML = pergunta[2].alternativa
    botao4.innerHTML = pergunta[3].alternativa
}

function respostaFem(numResposta) {
    console.log('número da resposta: ', numResposta)
    const perguntaAtual = perguntasFemininas[IndexPergunta]
    const variacao = perguntaAtual.respostas[numResposta].variacao

    pontuacaoFeminina[variacao]++

    IndexPergunta++

    if (IndexPergunta < perguntasFemininas.length) {
        mostrarPerguntaFem()
        mostrarALternativasFem();
    } else {
        finalizarQuizFem()
    }
}

function respostaMasc(numResposta) {
    console.log('número da resposta: ', numResposta)
    const perguntaAtual = perguntasMasculinas[IndexPergunta]
    const variacao = perguntaAtual.respostas[numResposta].variacao

    pontuacaoMasculina[variacao]++

    IndexPergunta++

    if (IndexPergunta < perguntasMasculinas.length) {
        mostrarPerguntaMasc()
        mostrarALternativasMasc();
    } else {
        finalizarQuizMasc()
    }

}

function finalQuiz(endTime, startTime, idQuiz) {
    console.log(idQuiz)
    fetch(`/usuarios/finalQuiz`,
        {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                endTimeServer: endTime,
                startTimeServer: startTime,
                idQuizServer: idQuiz
            })
        }
    ).then(function (response) {
        if (response.ok) {
            response.json().then(function (resposta) {
                console.log(resposta)
                console.log(JSON.stringify(resposta))

            })
        } else {
            console.log('Erro ao enviar dados para o Banco de Dados!')
        }
    }).catch(function (erro) { console.log(erro) })
}

function finalizarQuizFem() {
    var variacaoUsuarioFem = ''
    var pontuacaoVariacaoFem = 0
    for (var variacaonome in pontuacaoFeminina) {
        if (pontuacaoFeminina[variacaonome] > pontuacaoVariacaoFem) {
            variacaoUsuarioFem = variacaonome
            pontuacaoVariacaoFem = pontuacaoFeminina[variacaonome]
        }
    }

    var btnCima = document.getElementById('btnCima')
    var btnBaixo = document.getElementById('btnBaixo')
    var idVariacao = pegaridVariacao(variacaoUsuarioFem)
    var idUsuario = sessionStorage.ID_USUARIO
    btnCima.style.display = 'none'
    btnBaixo.style.display = 'none'
    perguntaElement.innerHTML = `Sua variação é: ${variacaoUsuarioFem}`
    var startTime = sessionStorage.DATA_INICIO
    PegaridQuiz(startTime, dataHoraMomento(), idVariacao, idUsuario)
    pegarDescricaoVariacao(idUsuario)
}

function finalizarQuizMasc() {
    var variacaoUsuarioMasc = ''
    var idUsuario = sessionStorage.ID_USUARIO

    var pontuacaoVariacaoMasc = 0
    for (var variacaonome in pontuacaoMasculina) {
        if (pontuacaoMasculina[variacaonome] > pontuacaoVariacaoMasc) {
            variacaoUsuarioMasc = variacaonome
            pontuacaoVariacaoMasc = pontuacaoMasculina[variacaonome]
        }

    }
    var btnCima = document.getElementById('btnCima')
    var btnBaixo = document.getElementById('btnBaixo')
    var idVariacao = pegaridVariacao(variacaoUsuarioMasc)
    btnCima.style.display = 'none'
    btnBaixo.style.display = 'none'
    perguntaElement.innerHTML = `Sua variação é: ${variacaoUsuarioMasc}`
    var startTime = sessionStorage.DATA_INICIO
    PegaridQuiz(startTime, dataHoraMomento(), idVariacao, idUsuario)

}

function pegarDescricaoVariacao(idVariacao) {
    fetch(`/usuarios/pegarDescricao/${idVariacao}`, { cache: 'no-store' }).then(function (response) {
        if (response.ok) {
            response.json().then(function (resposta) {
                var divDescricao = document.getElementById('descricao_txt')
                divDescricao.style.display = 'block'
                divDescricao.innerHTML = JSON.stringify(resposta[0].descricaoVariacao)
            })
        } else {
            console.log('Erro ao enviar dados para o Banco de Dados!')
        }
    }).catch(function (erro) {
        console.log(erro);
    })
}

function pegaridVariacao(nomeVariacao) {
    if (nomeVariacao == 'FadaAcucarada') return 1;
    else if (nomeVariacao == 'GisellePrimeiroAto') return 2;
    else if (nomeVariacao == 'GiselleSegundoAto') return 3;
    else if (nomeVariacao == 'Peasant') return 4;
    else if (nomeVariacao == 'Cupido') return 5;
    else if (nomeVariacao == 'Kitri') return 6;
    else if (nomeVariacao == 'Odile') return 7;
    else if (nomeVariacao == 'Aurora') return 8;
    else if (nomeVariacao == 'Esmeralda') return 9;
    else if (nomeVariacao == 'Paquita') return 10;
    else if (nomeVariacao == 'Raymonda') return 11;
    else if (nomeVariacao == 'Medora') return 12;
    else if (nomeVariacao == 'Gulnara') return 13;
    else if (nomeVariacao == 'NikiyaPrimeiroAto') return 14;
    else if (nomeVariacao == 'NikiyaSegundoAto') return 15;
    else if (nomeVariacao == 'OPássaroAzul') return 16;
    else if (nomeVariacao == 'Petrouchka') return 17;
    else if (nomeVariacao == 'Spartacus') return 18;
    else if (nomeVariacao == 'ChamasdeParis') return 19;
    else if (nomeVariacao == 'OTalismã') return 20;
    else if (nomeVariacao == 'Scherazade') return 21;
    else if (nomeVariacao == 'Solor') return 22;
    else if (nomeVariacao == 'Basilio') return 23;
    else if (nomeVariacao == 'PríncipeSiegfried') return 24;
    else if (nomeVariacao == 'PríncipeDésiré') return 25;
    else if (nomeVariacao == 'Albrecht') return 26;
    else if (nomeVariacao == 'JeandeBrienne') return 27;
    else if (nomeVariacao == 'Ali') return 28;
    else if (nomeVariacao == 'Acteon') return 29;
    else return 30;
}

function PegaridQuiz(dataInicioQuiz, endTime, fkVariacao, fkUsuario) {
    fetch(`/usuarios/PegaridQuiz/${dataInicioQuiz}`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            endTimeServer: endTime,
            fkVariacaoServer: fkVariacao,
            fkUsuarioServer: fkUsuario

        }),
        cache: 'no-store'
    }).then(function (response) {
        if (response.ok) {
            response.json().then(function (resposta) {
                sessionStorage.ID_QUIZ = resposta[0].idQuiz;
            });
        } else {
            console.log('Erro ao enviar dados para o Banco de Dados!');
        }
    }).catch(function (erro) {
        console.log('Erro na requisição:', erro);
    });
}


function enviarDadosQuiz(fkVariacao, fkUsuario) {
    fetch(`/usuarios/enviarDadosQuiz`,
        {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                fkUsuarioServer: fkUsuario,
                fkVariacaoServer: fkVariacao
            })
        }
    ).then(function (response) {
        if (response.ok) {
            response.json().then(function (resposta) {
                console.log(resposta)
                console.log(JSON.stringify(resposta))

            })
        } else {
            console.log('Erro ao enviar dados para o Banco de Dados!')
        }
    }).catch(function (erro) { console.log(erro) })
}

function inicioQuiz(startTime, tipo) {
    fetch(`/usuarios/inicioQuiz`,
        {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                startTimeServer: startTime,
                tipoServer: tipo
            })
        }
    ).then(function (response) {
        if (response.ok) {
            response.json().then(function (resposta) {
                console.log(resposta)
                console.log(JSON.stringify(resposta))
                sessionStorage.DATA_INICIO = resposta.startTime
            })
        } else {
            console.log('Erro ao enviar dados para o Banco de Dados!')
        }
    }).catch(function (erro) { console.log(erro) })
}